<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>乐其英语|乐在其中</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../res/layui/css/layui.css">
	<link rel="stylesheet" href="../res/static/css/mian.css">
	<script src="../res/layui/layui.js">

	</script>
	<script src="../res/static/js/leqisoft.js"></script>
	<script>
		var layer;

        layui.config({
            base: '../res/static/js/'
        }).use( ['layer', 'blog','jquery'], function(){



            var $ = layui.jquery;

            layer = layui.layer


            $(document).ready(function () {
                layer.load(2);
                var id = getURLValue("id")
                loadSegments($,id)
				loadContent($,id)
            })
        });

        //加载Content下的所有
        function loadSegments($,contentId) {
            $.ajax({
                url: "/segment/findByContentId?contentId=" + contentId,
				type:"GET",
				success:function (data) {
					var datas = $.parseJSON(data.data)

					for(var i = 0 ; i < datas.length ; i++){

                        $("#container").append(createItem($,i, datas[i]))

					}
                    layer.closeAll('loading');
					openDownloadApp()
                },
				error:function (data) {
                    layer.alert('sorry,请过会从新加载', {icon: 5});
                    openDownloadApp()
                }
            })
        }

        function createItem($,index ,data) {

            var title = $("<p style='font-size: 18px'><a href='/html/segmentInfo.html?id="+data.id+"'>"+(index+1)+"."+data.title+"</a></p>")

			return title
        }

        //加载Content内容并处理
        function loadContent($,contentId) {
            $.ajax({
                url: "/english/content/findById?id=" + contentId,
                type:"GET",
                success:function (data) {
                    var content = $.parseJSON(data.data)
					$("#title").append($("<a href='#'>"+content.title+"</a>"))

					if(isIn(content.updateDate,1000*60)){
                        $("#lunchDate").append($("<span>刚刚</span>"))
					}else{
                        $("#lunchDate").append($("<span>"+getSmpFormatDateByLong(content.updateDate,true)+"</span>"))
					}
                }

            })
        }
	</script>
</head>
<body class="lay-blog">
		<div class="header">
			<div class="header-wrap">
				<h1 class="logo pull-left">
					<a href="index.html">
						<img src="../res/static/images/logo.png" alt="" class="logo-img">
						<img src="../res/static/images/logo-text.png" alt="" class="logo-text">
					</a>
				</h1>
				<form class="layui-form blog-seach pull-left" action="">
					<div class="layui-form-item blog-sewrap">
					    <div class="layui-input-block blog-sebox">
					      <i class="layui-icon layui-icon-search"></i>
					      <input type="text" name="title" lay-verify="title" autocomplete="off"  class="layui-input">
					    </div>
					</div>
				</form>
				<div class="blog-nav pull-right">
					<ul class="layui-nav pull-left">
					  <li class="layui-nav-item layui-this"><a href="index.html">首页</a></li>
					  <li class="layui-nav-item"><a href="message.html">留言</a></li>
					  <li class="layui-nav-item"><a href="about.html">关于</a></li>
					</ul>
					<a href="#" class="personal pull-left">
						<i class="layui-icon layui-icon-username"></i>
					</a>
				</div>
				<div class="mobile-nav pull-right" id="mobile-nav">
					<a href="javascript:;">
						<i class="layui-icon layui-icon-more"></i>
					</a>
				</div>
			</div>
			<ul class="pop-nav" id="pop-nav">
				<li><a href="index.html">首页</a></li>
				<li><a href="message.html">留言</a></li>
				<li><a href="about.html">关于</a></li>
			</ul>
		</div>
		<div class="container-wrap">
			<div class="container container-message container-details">
					<div class="contar-wrap">
						<div class="item">
							<div class="item-box  layer-photos-demo1 layer-photos-demo">
								<h3 id="title"></h3>
								<h5  >发布于：<span id="lunchDate"></span></h5>
								<div class="contar-wrap" id="container">

								</div>
							</div>
						</div>	


					</div>
			</div>
		</div>
		<div class="footer">
			<p>
				<span>&copy; 2018</span>
				<span><a href="http://www.layui.com" target="_blank">layui.com</a></span> 
				<span>MIT license</span>
			</p>
			<p><span>人生就是一场修行</span></p>
		</div>

</body>
</html>